<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>网际协议IP | mkzpd</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="概述分析数据包的时候常常遇到对IP首部的分析，故把比较重要的知识记下来。">
<meta name="keywords" content="TCP&#x2F;IP">
<meta property="og:type" content="article">
<meta property="og:title" content="网际协议IP">
<meta property="og:url" content="http://yoursite.com/2019/08/03/网际协议IP/index.html">
<meta property="og:site_name" content="mkzpd">
<meta property="og:description" content="概述分析数据包的时候常常遇到对IP首部的分析，故把比较重要的知识记下来。">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://github.com/mkzpd/mkzpd.github.io/raw/master/pictures/IP-header.png">
<meta property="og:updated_time" content="2019-08-03T00:27:44.867Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="网际协议IP">
<meta name="twitter:description" content="概述分析数据包的时候常常遇到对IP首部的分析，故把比较重要的知识记下来。">
<meta name="twitter:image" content="https://github.com/mkzpd/mkzpd.github.io/raw/master/pictures/IP-header.png">
  
    <link rel="alternate" href="/atom.xml" title="mkzpd" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">mkzpd</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-网际协议IP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/03/网际协议IP/" class="article-date">
  <time datetime="2019-08-02T22:08:51.000Z" itemprop="datePublished">2019-08-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      网际协议IP
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>分析数据包的时候常常遇到对IP首部的分析，故把比较重要的知识记下来。</p>
<a id="more"></a>

<h2 id="IP数据报格式及首部中的各字段"><a href="#IP数据报格式及首部中的各字段" class="headerlink" title="IP数据报格式及首部中的各字段"></a>IP数据报格式及首部中的各字段</h2><p><img src="https://github.com/mkzpd/mkzpd.github.io/raw/master/pictures/IP-header.png" alt="IP数据报格式及首部中的各字段图示"></p>
<p>普通的IP首部长为20个字节，除非含有选项字段。由于TCP/IP首部中所有的二进制整数在网络中传输时都要求以大端字节序，因此它又<br>称作网络字节序。</p>
<p>现对IP首部字段作说明:</p>
<ol>
<li><p>占4个位的版本用以说明使用的IP协议版本号，目前使用最多的是版本号4,因此有时也称为IPv4。IPv4即将面临不够用的情况，因此<br>出现了IPv4的升级版IPv6.</p>
</li>
<li><p>4位首部长度指的是首部占32bit子的数目，包括任何选项。由于它是一个4比特字段，最大值表示为(0b)1111,即十六进制0xF,十进制<br>为15, 32bit是4字节，所以首部最长为15 * 4 = 60字节。普通IP数据报(没有任何选择项)字段的值是5,即20字节。</p>
</li>
<li><p>8位的服务类型(TOS)字段包括一个3bit的优先权字段(现在已被忽略)，4bit的TOS子字段和1bit未用位但必须置0。4bit的TOS分别代<br>表:最小时延，最大吞吐量，最高可靠性和最小费用。4bit中只能置其中1bit。如果所有4bit均为0,那么就意味着是一般服务。比如<br>Telnet的4bit的TOS值表示为1000,即要求Telnet是最小时延，加上1bit未用位但必须置0的位，那么Telnet的TOS值的十六进制为<br>0x10,如果用tcpdump抓包分析的时候会看到相应的十六进制输出。不过现在大多数的TCP/IP实现都不支持TOS特性，即使设置了相<br>应的位表示，最终还是看路由器执行与否。</p>
</li>
<li><p>16位总长度字段是指整个IP数据报的长度，以字节为单位。利用首部长度字段和总长度字段，就可以知道IP数据报中数据内容的起始<br>位置和长度。由于该字段长16比特，所以IP数据报最长可达65535字节(超级通道的MTU为65535,它的意思其实不是一个真正的<br>MTU— —它使用了最长的IP数据报)。当数据报被分片时，该字段的值也随着变化。总长度字段是IP首部中必要的内容，因为一些<br>数据链路(如以太网)需要填充一些数据以达到最小长度。尽管以太网的最小帧长为46字节，但是IP数据可能会更短。如果没有总长度<br>字段，那么IP层就不知道46字节中有多少是IP数据报的内容。</p>
</li>
<li><p>16位的标识字段唯一地标识主机发送的每一份数据报，通常每发送一份报文它的值就会加1。以后再详细补充。</p>
</li>
<li><p>3位标志字段以后再详细补充。</p>
</li>
<li><p>13位片偏移字段以后再详细补充。</p>
</li>
<li><p>8位TTL生存时间字段最大值为255,该字段设置了数据报可以经过的最多路由数，它指定了数据报的生存时间。TTL的初始值由源主机<br>设置(通常为32或64)，一旦经过一个处理它的路由器，它的值就减去1。当该字段的值为0时，数据报就被丢弃，并发送ICMP报文通<br>知源主机。</p>
</li>
<li><p>8位的协议字段用来表示它如何被IP用来对数据报进行分用。根据它可以识别是哪个协议向IP传送数据，其中<font color="red"><b>1表示ICMP协议，<br>2表示IGMP协议，6表示TCP协议，17表示UDP协议。</b></font></p>
</li>
<li><p>16位首部检验和字段是根据IP首部计算的检验和码。它不对首部后面的数据进行计算。ICMP，IGMP，UDP和TCP在它们各自的首部<br>中均含有同时覆盖首部和数据检验和码。</p>
</li>
<li><p>32位的源IP地址和目的IP地址这个比较好理解，每一份IP数据报都包含源IP地址和目的IP地址，它们都是32bit的值。</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/03/网际协议IP/" data-id="cjyusa7ze0011eifxxrn92j25" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TCP-IP/">TCP/IP</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/08/02/链路层学习笔记/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">链路层学习笔记</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Leetcode/">Leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP-IP/">TCP/IP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客搭建/">博客搭建</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/系统编程/">系统编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络编程/">网络编程</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Leetcode/" style="font-size: 15px;">Leetcode</a> <a href="/tags/TCP-IP/" style="font-size: 20px;">TCP/IP</a> <a href="/tags/博客搭建/" style="font-size: 10px;">博客搭建</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/系统编程/" style="font-size: 17.5px;">系统编程</a> <a href="/tags/网络编程/" style="font-size: 12.5px;">网络编程</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/08/03/网际协议IP/">网际协议IP</a>
          </li>
        
          <li>
            <a href="/2019/08/02/链路层学习笔记/">链路层学习笔记</a>
          </li>
        
          <li>
            <a href="/2019/07/22/典型的并发服务器程序轮廓/">典型的并发服务器程序轮廓</a>
          </li>
        
          <li>
            <a href="/2019/07/19/IP子网的划分/">IP子网的划分</a>
          </li>
        
          <li>
            <a href="/2019/07/16/ping-IP后敲回车-发包前会发生什么/">ping IP后敲回车,发包前会发生什么</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 mkzpd<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>